/home/konstantin.smirnov/miniconda3/envs/project_env/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type             | Params | Mode
--------------------------------------------------------
0 | embedding  | Embedding        | 32     | train
1 | lstm1      | LSTM             | 70.7 K | train
2 | activation | ReLU             | 0      | train
3 | lstm2      | LSTM             | 132 K  | train
4 | lstm3      | LSTM             | 132 K  | train
5 | lstm4      | LSTM             | 132 K  | train
6 | fc         | Linear           | 516    | train
7 | loss_fn    | CrossEntropyLoss | 0      | train
--------------------------------------------------------
467 K     Trainable params
0         Non-trainable params
467 K     Total params
1.870     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
Epoch 27: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1250/1250 [00:29<00:00, 41.92it/s, v_num=zmd4]
/home/konstantin.smirnov/miniconda3/envs/project_env/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.
/home/konstantin.smirnov/miniconda3/envs/project_env/lib/python3.9/site-packages/pytorch_lightning/utilities/data.py:78: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 64. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
                                                                                                                                                        
/home/konstantin.smirnov/miniconda3/envs/project_env/lib/python3.9/site-packages/pytorch_lightning/utilities/data.py:78: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 16. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
Epoch 0, global step 1250: 'val_loss' reached 0.69288 (best 0.69288), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.69.ckpt' as top 1
Epoch 1, global step 2500: 'val_loss' reached 0.68979 (best 0.68979), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.69.ckpt' as top 1
Epoch 2, global step 3750: 'val_loss' reached 0.68429 (best 0.68429), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.68.ckpt' as top 1
Epoch 3, global step 5000: 'val_loss' reached 0.67997 (best 0.67997), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.68.ckpt' as top 1
Epoch 4, global step 6250: 'val_loss' reached 0.67170 (best 0.67170), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.67.ckpt' as top 1
Epoch 5, global step 7500: 'val_loss' reached 0.66507 (best 0.66507), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.67.ckpt' as top 1
Epoch 6, global step 8750: 'val_loss' reached 0.65994 (best 0.65994), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.66.ckpt' as top 1
Epoch 7, global step 10000: 'val_loss' reached 0.65464 (best 0.65464), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.65.ckpt' as top 1
Epoch 8, global step 11250: 'val_loss' reached 0.65057 (best 0.65057), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.65.ckpt' as top 1
Epoch 9, global step 12500: 'val_loss' reached 0.64364 (best 0.64364), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.64.ckpt' as top 1
Epoch 10, global step 13750: 'val_loss' reached 0.64265 (best 0.64265), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.64.ckpt' as top 1
Epoch 11, global step 15000: 'val_loss' reached 0.62991 (best 0.62991), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.63.ckpt' as top 1
Epoch 12, global step 16250: 'val_loss' reached 0.61589 (best 0.61589), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.62.ckpt' as top 1
Epoch 13, global step 17500: 'val_loss' reached 0.59625 (best 0.59625), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.60.ckpt' as top 1
Epoch 14, global step 18750: 'val_loss' reached 0.59328 (best 0.59328), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.59.ckpt' as top 1
Epoch 15, global step 20000: 'val_loss' reached 0.58304 (best 0.58304), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.58.ckpt' as top 1
Epoch 16, global step 21250: 'val_loss' reached 0.56682 (best 0.56682), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.57.ckpt' as top 1
Epoch 17, global step 22500: 'val_loss' reached 0.54373 (best 0.54373), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.54.ckpt' as top 1
Epoch 18, global step 23750: 'val_loss' reached 0.53336 (best 0.53336), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.53.ckpt' as top 1
Epoch 19, global step 25000: 'val_loss' was not in top 1
Epoch 20, global step 26250: 'val_loss' reached 0.51701 (best 0.51701), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.52.ckpt' as top 1
Epoch 21, global step 27500: 'val_loss' reached 0.50552 (best 0.50552), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.51.ckpt' as top 1
Epoch 22, global step 28750: 'val_loss' was not in top 1
Epoch 23, global step 30000: 'val_loss' reached 0.49523 (best 0.49523), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.50.ckpt' as top 1
Epoch 24, global step 31250: 'val_loss' was not in top 1
Epoch 25, global step 32500: 'val_loss' reached 0.49123 (best 0.49123), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.49.ckpt' as top 1
Epoch 26, global step 33750: 'val_loss' reached 0.48946 (best 0.48946), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.49.ckpt' as top 1
Epoch 27, global step 35000: 'val_loss' reached 0.47568 (best 0.47568), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.48.ckpt' as top 1
Epoch 28, global step 36250: 'val_loss' reached 0.47341 (best 0.47341), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.47.ckpt' as top 1
Epoch 29, global step 37500: 'val_loss' was not in top 1
Epoch 30, global step 38750: 'val_loss' reached 0.46144 (best 0.46144), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.46.ckpt' as top 1
Epoch 31, global step 40000: 'val_loss' reached 0.45756 (best 0.45756), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.46.ckpt' as top 1
Epoch 32, global step 41250: 'val_loss' was not in top 1
Epoch 33, global step 42500: 'val_loss' was not in top 1
Epoch 34, global step 43750: 'val_loss' was not in top 1
Epoch 35, global step 45000: 'val_loss' reached 0.44076 (best 0.44076), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.44.ckpt' as top 1
Epoch 36, global step 46250: 'val_loss' was not in top 1
Epoch 37, global step 47500: 'val_loss' was not in top 1
Epoch 38, global step 48750: 'val_loss' reached 0.43692 (best 0.43692), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.44.ckpt' as top 1
Epoch 39, global step 50000: 'val_loss' was not in top 1
Epoch 40, global step 51250: 'val_loss' reached 0.42735 (best 0.42735), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.43.ckpt' as top 1
Epoch 41, global step 52500: 'val_loss' was not in top 1
Epoch 42, global step 53750: 'val_loss' was not in top 1
Epoch 43, global step 55000: 'val_loss' was not in top 1
Epoch 44, global step 56250: 'val_loss' reached 0.41578 (best 0.41578), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.42.ckpt' as top 1
Epoch 45, global step 57500: 'val_loss' was not in top 1
Epoch 46, global step 58750: 'val_loss' was not in top 1
Epoch 47, global step 60000: 'val_loss' reached 0.40622 (best 0.40622), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.41-v1.ckpt' as top 1
Epoch 48, global step 61250: 'val_loss' was not in top 1
Epoch 49, global step 62500: 'val_loss' reached 0.40391 (best 0.40391), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.40.ckpt' as top 1
Epoch 50, global step 63750: 'val_loss' was not in top 1
Epoch 51, global step 65000: 'val_loss' reached 0.40187 (best 0.40187), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.40.ckpt' as top 1
Epoch 52, global step 66250: 'val_loss' was not in top 1
Epoch 53, global step 67500: 'val_loss' reached 0.40117 (best 0.40117), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.40.ckpt' as top 1
Epoch 54, global step 68750: 'val_loss' reached 0.39142 (best 0.39142), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.39.ckpt' as top 1
Epoch 55, global step 70000: 'val_loss' reached 0.38276 (best 0.38276), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.38.ckpt' as top 1
Epoch 56, global step 71250: 'val_loss' reached 0.38022 (best 0.38022), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.38.ckpt' as top 1
Epoch 57, global step 72500: 'val_loss' was not in top 1
Epoch 58, global step 73750: 'val_loss' reached 0.37480 (best 0.37480), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.37-v1.ckpt' as top 1
Epoch 59, global step 75000: 'val_loss' was not in top 1
Epoch 60, global step 76250: 'val_loss' was not in top 1
Epoch 61, global step 77500: 'val_loss' reached 0.37178 (best 0.37178), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.37-v1.ckpt' as top 1
Epoch 62, global step 78750: 'val_loss' was not in top 1
Epoch 63, global step 80000: 'val_loss' reached 0.37050 (best 0.37050), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.37-v1.ckpt' as top 1
Epoch 64, global step 81250: 'val_loss' reached 0.36711 (best 0.36711), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.37-v1.ckpt' as top 1
Epoch 65, global step 82500: 'val_loss' reached 0.36612 (best 0.36612), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.37-v1.ckpt' as top 1
Epoch 66, global step 83750: 'val_loss' was not in top 1
Epoch 67, global step 85000: 'val_loss' reached 0.36288 (best 0.36288), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.36.ckpt' as top 1
Epoch 68, global step 86250: 'val_loss' reached 0.35988 (best 0.35988), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.36.ckpt' as top 1
Epoch 69, global step 87500: 'val_loss' reached 0.35769 (best 0.35769), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.36.ckpt' as top 1
Epoch 70, global step 88750: 'val_loss' reached 0.35056 (best 0.35056), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.35.ckpt' as top 1
Epoch 71, global step 90000: 'val_loss' was not in top 1
Epoch 72, global step 91250: 'val_loss' was not in top 1
Epoch 73, global step 92500: 'val_loss' was not in top 1
Epoch 74, global step 93750: 'val_loss' reached 0.34725 (best 0.34725), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.35.ckpt' as top 1
Epoch 75, global step 95000: 'val_loss' was not in top 1
Epoch 76, global step 96250: 'val_loss' was not in top 1
Epoch 77, global step 97500: 'val_loss' reached 0.33619 (best 0.33619), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.34.ckpt' as top 1
Epoch 78, global step 98750: 'val_loss' was not in top 1
Epoch 79, global step 100000: 'val_loss' was not in top 1
Epoch 80, global step 101250: 'val_loss' was not in top 1
Epoch 81, global step 102500: 'val_loss' was not in top 1
Epoch 82, global step 103750: 'val_loss' reached 0.33388 (best 0.33388), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.33.ckpt' as top 1
Epoch 83, global step 105000: 'val_loss' reached 0.33022 (best 0.33022), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.33.ckpt' as top 1
Epoch 84, global step 106250: 'val_loss' reached 0.32449 (best 0.32449), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.32.ckpt' as top 1
Epoch 85, global step 107500: 'val_loss' was not in top 1
Epoch 86, global step 108750: 'val_loss' was not in top 1
Epoch 87, global step 110000: 'val_loss' was not in top 1
Epoch 88, global step 111250: 'val_loss' reached 0.32360 (best 0.32360), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.32.ckpt' as top 1
Epoch 89, global step 112500: 'val_loss' was not in top 1
Epoch 90, global step 113750: 'val_loss' was not in top 1
Epoch 91, global step 115000: 'val_loss' reached 0.31503 (best 0.31503), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.32.ckpt' as top 1
Epoch 92, global step 116250: 'val_loss' was not in top 1
Epoch 93, global step 117500: 'val_loss' was not in top 1
Epoch 94, global step 118750: 'val_loss' was not in top 1
Epoch 95, global step 120000: 'val_loss' was not in top 1
Epoch 96, global step 121250: 'val_loss' reached 0.31220 (best 0.31220), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len400-best-checkpoint-val_loss=0.31.ckpt' as top 1
Epoch 97, global step 122500: 'val_loss' was not in top 1
Epoch 98, global step 123750: 'val_loss' was not in top 1
Epoch 99, global step 125000: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_epochs=100` reached.
