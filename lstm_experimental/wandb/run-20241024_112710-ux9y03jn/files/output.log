/home/konstantin.smirnov/miniconda3/envs/project_env/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type             | Params | Mode
--------------------------------------------------------
0 | embedding  | Embedding        | 32     | train
1 | lstm1      | LSTM             | 70.7 K | train
2 | activation | ReLU             | 0      | train
3 | lstm2      | LSTM             | 132 K  | train
4 | lstm3      | LSTM             | 132 K  | train
5 | lstm4      | LSTM             | 132 K  | train
6 | fc         | Linear           | 516    | train
7 | loss_fn    | CrossEntropyLoss | 0      | train
--------------------------------------------------------
467 K     Trainable params
0         Non-trainable params
467 K     Total params
1.870     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
Epoch 26: 100%|██████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:00<00:00, 53.42it/s, v_num=03jn]
/home/konstantin.smirnov/miniconda3/envs/project_env/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.
/home/konstantin.smirnov/miniconda3/envs/project_env/lib/python3.9/site-packages/pytorch_lightning/utilities/data.py:78: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 32. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
/home/konstantin.smirnov/miniconda3/envs/project_env/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=11` in the `DataLoader` to improve performance.
                                                                                                                                                 
/home/konstantin.smirnov/miniconda3/envs/project_env/lib/python3.9/site-packages/pytorch_lightning/utilities/data.py:78: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 8. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
Epoch 0, global step 50: 'val_loss' reached 0.64359 (best 0.64359), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.64.ckpt' as top 1
Epoch 1, global step 100: 'val_loss' reached 0.63383 (best 0.63383), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.63.ckpt' as top 1
Epoch 2, global step 150: 'val_loss' reached 0.62576 (best 0.62576), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.63.ckpt' as top 1
Epoch 3, global step 200: 'val_loss' reached 0.62164 (best 0.62164), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.62.ckpt' as top 1
Epoch 4, global step 250: 'val_loss' reached 0.61485 (best 0.61485), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.61.ckpt' as top 1
Epoch 5, global step 300: 'val_loss' reached 0.61047 (best 0.61047), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.61.ckpt' as top 1
Epoch 6, global step 350: 'val_loss' reached 0.60422 (best 0.60422), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.60.ckpt' as top 1
Epoch 7, global step 400: 'val_loss' reached 0.59928 (best 0.59928), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.60.ckpt' as top 1
Epoch 8, global step 450: 'val_loss' reached 0.59662 (best 0.59662), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.60.ckpt' as top 1
Epoch 9, global step 500: 'val_loss' reached 0.59115 (best 0.59115), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.59.ckpt' as top 1
Epoch 10, global step 550: 'val_loss' reached 0.58765 (best 0.58765), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.59.ckpt' as top 1
Epoch 11, global step 600: 'val_loss' reached 0.58398 (best 0.58398), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.58.ckpt' as top 1
Epoch 12, global step 650: 'val_loss' reached 0.58005 (best 0.58005), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.58.ckpt' as top 1
Epoch 13, global step 700: 'val_loss' reached 0.57711 (best 0.57711), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.58.ckpt' as top 1
Epoch 14, global step 750: 'val_loss' reached 0.57376 (best 0.57376), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.57.ckpt' as top 1
Epoch 15, global step 800: 'val_loss' was not in top 1
Epoch 16, global step 850: 'val_loss' reached 0.56862 (best 0.56862), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.57.ckpt' as top 1
Epoch 17, global step 900: 'val_loss' reached 0.56739 (best 0.56739), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.57.ckpt' as top 1
Epoch 18, global step 950: 'val_loss' reached 0.55919 (best 0.55919), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.56.ckpt' as top 1
Epoch 19, global step 1000: 'val_loss' was not in top 1
Epoch 20, global step 1050: 'val_loss' was not in top 1
Epoch 21, global step 1100: 'val_loss' was not in top 1
Epoch 22, global step 1150: 'val_loss' was not in top 1
Epoch 23, global step 1200: 'val_loss' reached 0.55842 (best 0.55842), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.56.ckpt' as top 1
Epoch 24, global step 1250: 'val_loss' reached 0.55253 (best 0.55253), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.55.ckpt' as top 1
Epoch 25, global step 1300: 'val_loss' reached 0.55189 (best 0.55189), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.55.ckpt' as top 1
Epoch 26, global step 1350: 'val_loss' reached 0.55089 (best 0.55089), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.55.ckpt' as top 1
Epoch 27, global step 1400: 'val_loss' reached 0.54942 (best 0.54942), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.55.ckpt' as top 1
Epoch 28, global step 1450: 'val_loss' reached 0.54671 (best 0.54671), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.55.ckpt' as top 1
Epoch 29, global step 1500: 'val_loss' was not in top 1
Epoch 30, global step 1550: 'val_loss' reached 0.53989 (best 0.53989), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.54.ckpt' as top 1
Epoch 31, global step 1600: 'val_loss' was not in top 1
Epoch 32, global step 1650: 'val_loss' was not in top 1
Epoch 33, global step 1700: 'val_loss' reached 0.53315 (best 0.53315), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.53.ckpt' as top 1
Epoch 34, global step 1750: 'val_loss' was not in top 1
Epoch 35, global step 1800: 'val_loss' reached 0.53220 (best 0.53220), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.53.ckpt' as top 1
Epoch 36, global step 1850: 'val_loss' reached 0.53003 (best 0.53003), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.53.ckpt' as top 1
Epoch 37, global step 1900: 'val_loss' was not in top 1
Epoch 38, global step 1950: 'val_loss' was not in top 1
Epoch 39, global step 2000: 'val_loss' was not in top 1
Epoch 40, global step 2050: 'val_loss' reached 0.52808 (best 0.52808), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.53.ckpt' as top 1
Epoch 41, global step 2100: 'val_loss' reached 0.51954 (best 0.51954), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.52.ckpt' as top 1
Epoch 42, global step 2150: 'val_loss' was not in top 1
Epoch 43, global step 2200: 'val_loss' was not in top 1
Epoch 44, global step 2250: 'val_loss' was not in top 1
Epoch 45, global step 2300: 'val_loss' reached 0.51813 (best 0.51813), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.52.ckpt' as top 1
Epoch 46, global step 2350: 'val_loss' was not in top 1
Epoch 47, global step 2400: 'val_loss' reached 0.51316 (best 0.51316), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.51.ckpt' as top 1
Epoch 48, global step 2450: 'val_loss' reached 0.51244 (best 0.51244), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.51.ckpt' as top 1
Epoch 49, global step 2500: 'val_loss' reached 0.50662 (best 0.50662), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.51.ckpt' as top 1
Epoch 50, global step 2550: 'val_loss' was not in top 1
Epoch 51, global step 2600: 'val_loss' was not in top 1
Epoch 52, global step 2650: 'val_loss' was not in top 1
Epoch 53, global step 2700: 'val_loss' reached 0.49829 (best 0.49829), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.50.ckpt' as top 1
Epoch 54, global step 2750: 'val_loss' was not in top 1
Epoch 55, global step 2800: 'val_loss' was not in top 1
Epoch 56, global step 2850: 'val_loss' was not in top 1
Epoch 57, global step 2900: 'val_loss' was not in top 1
Epoch 58, global step 2950: 'val_loss' reached 0.49673 (best 0.49673), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.50.ckpt' as top 1
Epoch 59, global step 3000: 'val_loss' was not in top 1
Epoch 60, global step 3050: 'val_loss' was not in top 1
Epoch 61, global step 3100: 'val_loss' was not in top 1
Epoch 62, global step 3150: 'val_loss' was not in top 1
Epoch 63, global step 3200: 'val_loss' reached 0.49017 (best 0.49017), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.49.ckpt' as top 1
Epoch 64, global step 3250: 'val_loss' was not in top 1
Epoch 65, global step 3300: 'val_loss' reached 0.48285 (best 0.48285), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.48.ckpt' as top 1
Epoch 66, global step 3350: 'val_loss' was not in top 1
Epoch 67, global step 3400: 'val_loss' was not in top 1
Epoch 68, global step 3450: 'val_loss' was not in top 1
Epoch 69, global step 3500: 'val_loss' was not in top 1
Epoch 70, global step 3550: 'val_loss' reached 0.47940 (best 0.47940), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.48.ckpt' as top 1
Epoch 71, global step 3600: 'val_loss' was not in top 1
Epoch 72, global step 3650: 'val_loss' was not in top 1
Epoch 73, global step 3700: 'val_loss' reached 0.47232 (best 0.47232), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.47.ckpt' as top 1
Epoch 74, global step 3750: 'val_loss' was not in top 1
Epoch 75, global step 3800: 'val_loss' was not in top 1
Epoch 76, global step 3850: 'val_loss' reached 0.47170 (best 0.47170), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.47.ckpt' as top 1
Epoch 77, global step 3900: 'val_loss' was not in top 1
Epoch 78, global step 3950: 'val_loss' was not in top 1
Epoch 79, global step 4000: 'val_loss' was not in top 1
Epoch 80, global step 4050: 'val_loss' was not in top 1
Epoch 81, global step 4100: 'val_loss' was not in top 1
Epoch 82, global step 4150: 'val_loss' was not in top 1
Epoch 83, global step 4200: 'val_loss' was not in top 1
Epoch 84, global step 4250: 'val_loss' was not in top 1
Epoch 85, global step 4300: 'val_loss' was not in top 1
Epoch 86, global step 4350: 'val_loss' was not in top 1
Epoch 87, global step 4400: 'val_loss' reached 0.47102 (best 0.47102), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.47.ckpt' as top 1
Epoch 88, global step 4450: 'val_loss' reached 0.46921 (best 0.46921), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.47.ckpt' as top 1
Epoch 89, global step 4500: 'val_loss' was not in top 1
Epoch 90, global step 4550: 'val_loss' was not in top 1
Epoch 91, global step 4600: 'val_loss' was not in top 1
Epoch 92, global step 4650: 'val_loss' reached 0.45826 (best 0.45826), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.46.ckpt' as top 1
Epoch 93, global step 4700: 'val_loss' was not in top 1
Epoch 94, global step 4750: 'val_loss' was not in top 1
Epoch 95, global step 4800: 'val_loss' was not in top 1
Epoch 96, global step 4850: 'val_loss' reached 0.45704 (best 0.45704), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.46.ckpt' as top 1
Epoch 97, global step 4900: 'val_loss' was not in top 1
Epoch 98, global step 4950: 'val_loss' reached 0.45644 (best 0.45644), saving model to '/home/konstantin.smirnov/associative-recurrent-memory-transformer/lstm_experimental/checkpoints/binary_copy/len40-best-checkpoint-val_loss=0.46.ckpt' as top 1
Epoch 99, global step 5000: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_epochs=100` reached.
